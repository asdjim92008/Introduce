// ğŸ—“ï¸ å¤šç­†è³‡æ–™ + åˆ†é¡
const itineraryData = {
  1: [
    {
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
    {
      name: "é¼æ³°è±",
      category: "ç¾é£Ÿ",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/2/28/Din_Tai_Fung.jpg", 
			review: "å¿…åƒå°ç± åŒ…ååº—ã€‚" 
		}
      ]
    }
  ],
  2: [
    {
      name: "ä¸­æ­£ç´€å¿µå ‚",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "å……æ»¿æ­·å²æ°›åœçš„å»ºç¯‰ã€‚" 
		}
      ]
    },
    {
      name: "è¥¿é–€ç”º",
      category: "è³¼ç‰©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ç†±é¬§çš„å•†åœˆï¼Œéå¸¸å¥½é€›ã€‚" 
		}
      ]
    }
  ]
  // å…¶ä»–å¤©å¯ä¾éœ€æ±‚è‡ªè¡ŒåŠ 
};

// ä¸åŒåˆ†é¡å°æ‡‰é¡è‰²èˆ‡SVGåœ–ç¤º
const categoryStyles = {
  "ç¾é£Ÿ": {
    color: "#FFB870",
	'class': 'tag-food',
    icon: `ğŸ½ï¸`
  },
  "æ™¯é»": {
    color: "#7ED957",
	'class': 'tag-spot',
    icon: `ğŸï¸`
  },
  "è³¼ç‰©": {
    color: "#66B3FF",
	'class': 'tag-shop',
    icon: `ğŸ›ï¸`
  }
};

const tabButtons = document.querySelectorAll('.tab-button');
const daySchedules = document.querySelectorAll('.day-schedule');
const placeInfoEl = document.getElementById('place-info');
const prevInfoBtn = document.getElementById('prev-info');
const nextInfoBtn = document.getElementById('next-info');
const mapFrame = document.getElementById('mapFrame');

let currentPlace = null;
let currentInfoIndex = 0;

// æ¸²æŸ“æ¯æ—¥è¡Œç¨‹
function renderItinerary() {
  daySchedules.forEach(schedule => {
    const day = schedule.getAttribute('data-day');
    schedule.innerHTML = '';

    (itineraryData[day] || []).forEach((place) => {
      const category = categoryStyles[place.category] || { color: "#ccc", icon: "" };
      const item = document.createElement('div');
	  item.className = 'spot-button';
	  /*
      item.className = 'itinerary-item';
      item.style.background = category.color;
      item.innerHTML = `${category.icon} ${place.name}`;
	  */
	  const cfg = categoryStyles[place.category];
	  item.innerHTML = `<span>${place.name}</span><span class="tag ${cfg.class}">${cfg.icon} ${place.category}</span>`;

      item.addEventListener('click', () => {
        currentPlace = place;
        currentInfoIndex = 0;
        showPlaceInfo();
		// æ¸…é™¤å…¶ä»– item çš„ active class
		document.querySelectorAll('.spot-button').forEach(el => {
			el.classList.remove('active');
		});

		  // å¹«ç›®å‰é»åˆ°çš„ item åŠ ä¸Š active
		item.classList.add('active');
      });

      schedule.appendChild(item);
    });
  });
}

// é¡¯ç¤ºæ™¯é»è³‡è¨Š
function showPlaceInfo() {
  if (!currentPlace) return;
  const info = currentPlace.info[currentInfoIndex];
  placeInfoEl.innerHTML = `
    <img src="${info.img}" alt="${currentPlace.name}">
    <h3>${currentPlace.name} <span style="font-size:0.8rem;color:#666;">(${currentPlace.category})</span></h3>
    <p>${info.review}</p>
    <p style="font-size:0.8rem;color:#888;">${currentInfoIndex + 1} / ${currentPlace.info.length}</p>
  `;
  mapFrame.src = currentPlace.map_location;
}

// åˆ‡æ›è³‡è¨Š
prevInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex - 1 + currentPlace.info.length) % currentPlace.info.length;
    showPlaceInfo();
  }
});

nextInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex + 1) % currentPlace.info.length;
    showPlaceInfo();
  }
});

// Tabs åˆ‡æ›
tabButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const day = btn.getAttribute('data-day');
    tabButtons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    daySchedules.forEach(s => s.classList.remove('active'));
    document.querySelector(`.day-schedule[data-day="${day}"]`).classList.add('active');
  });
});

// åˆå§‹åŒ–
window.addEventListener('DOMContentLoaded', renderItinerary);