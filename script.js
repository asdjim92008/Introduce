// üóìÔ∏è Â§öÁ≠ÜË≥áÊñô + ÂàÜÈ°û
const itineraryData = {
  1: [
    {
      name: "ËÇâËõãÈ£ØÁ≥∞",
      category: "ÁæéÈ£ü",
	  map_location:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6020.424447080302!2d127.64619103042679!3d26.204295974549215!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34e569b79929e9c5%3A0x97508c627485ac4a!2z54-A5aGU55GqIOmCo-mcuOapn-WgtOWci-WFp-e3muWIsOmBlOWkp-W7s-W6lw!5e0!3m2!1szh-TW!2stw!4v1761056553806!5m2!1szh-TW!2stw",
      info: [
		{ 
			img: "day1/t1menu.jpg", 
			review: "ËèúÂñÆ" 
		},
		{ 
			img: "day1/t1p1.jpg", 
			review: "ÈÄôÊ¨°ÂìÅÂöêÂúãÂÖßÁ∑öÁöÑÂàÜÂ∫óÔºåÈúÄË¶ÅÊéíÈöäÂçäÂ∞èÊôÇÂ∑¶Âè≥ÔºåÊúÄÂ•ΩÂêÉÁöÑÊòØÂ±±Ëã¶ÁìúÂè£Âë≥ÔºåÊé•ËëóÊòØÊãõÁâåÂè£Âë≥ÔºåÊï¥È´î‰æÜË™™Êê≠ÈÖçÂçàÈ§êËÇâÊòØÂ•ΩÂêÉÁöÑÔºå‰ΩÜÂÉπÊ†ºÂÅèË≤¥" 
		},
        { 
			img: "day1/t1p2.jpg", 
			review: "Âú®ÂÅöÊ≤ñÁπ©ÊóÖÈÅäÂäüË™≤ÁöÑÊôÇÂÄôÔºåÂæàÂ§ö‰∫∫Êé®Ëñ¶ÁöÑÈÇ£Èú∏Ê©üÂ†¥ÂøÖÂêÉ„ÄåË±¨ËÇâËõãÈ£ØÁ≥∞ pork tamago onigiri„ÄçÔºåÈÇÑÂ•ΩÊàë‰∏ÄÊó©8Ôºö30Ë¶ÅÂú®ÈÇ£Èú∏Ê©üÂ†¥ÂùêOTSÁöÑÊé•ÈßÅËªäÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÖà‰æÜÂöêÈÆÆ‰∏ÄÁï™ÔºåËÄå‰∏î‰πü‰∏çÁî®ÊéíÈöä~Âè£Âë≥ÈÇÑÁÆó‰∏çÈåØÔºå‰ªΩÈáè‰πüÈÅ©‰∏≠Ôºå‰ΩÜÊòØ‰πü‰∏çËÉΩÁÆóÊòØÂøÖÂêÉÁæéÈ£ü~ÊáâË©≤Ë™™ÊòØÂêÉ‰∏ÄÁ®ÆÂÑÄÂºèÊÑüÔºåÊúâ‰æÜÂêÉÈÅéÊâçËÉΩÁÆó‰æÜÈÅéÈÇ£Èú∏Ê©üÂ†¥ÂêßüòÅ" 
		},
        { 
			img: "day1/t1p3.jpg", 
			review: "ÈÇ£Èú∏Ê©üÂ†¥ÔºàNaha AirportÔºâ9:20ÊäµÈÅîÔºåÂá∫ÈóúÂæåÂâçÂæÄÂúãÂÖßÁ∑öÊâæÂêÉÁöÑ...ÊéíÈöäÈªûÈ§êÂà∞ÂèñÈ§êÔºåÂ§ßÊ¶ÇÂè™Ëä±‰∫Ü15ÂàÜÈêòÔºåË†ªÂø´ÁöÑ„ÄÇÈ£ØÂúòÁúüÁöÑÂ•ΩÂ•ΩÂêÉÔºåËã¶ÁìúÂ§©Â©¶ÁæÖÂè£Âë≥Ë∂ÖÁ¥öÂ•ΩÂêÉ....ÂùáÈä∑Á¥Ñ600-650Êó•ÂÖÉ" 
		}
      ]
    },
	{
      name: "‰ΩèÂÆø„Éõ„ÉÜ„É´„Éà„Éº„Éû„ÇπÁâßÂøó",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d223.7101187135447!2d127.69089730858086!3d26.217428059682504!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34e5697b3ae7241d%3A0x2f2434c1d31cb98!2zQW5uZXNzbyDniaflv5flhazlr5PlvI_po6_lupc!5e0!3m2!1szh-TW!2stw!4v1761230683165!5m2!1szh-TW!2stw",
      info: [
        { 
			img: "day1/t2p1.png", 
			review: "" 
		},
        { 
			img: "day1/t2p2.png", 
			review: "" 
		},
		{ 
			img: "day1/t2p3.png", 
			review: "" 
		},
		{ 
			img: "day1/t2p4.png", 
			review: "" 
		},
      ]
    },
	{
      name: "Âè∞Âåó101",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "Â£ØËßÄÁöÑÂú∞Ê®ôÂª∫ÁØâÔºåËßÄÊôØÂè∞Ë¶ñÈáéÊ•µ‰Ω≥„ÄÇ" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "Âª∫ÁØâÂ§úÊôØÈùûÂ∏∏Â£ØÈ∫ó„ÄÇ" 
		}
      ]
    },
	{
      name: "Âè∞Âåó101",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "Â£ØËßÄÁöÑÂú∞Ê®ôÂª∫ÁØâÔºåËßÄÊôØÂè∞Ë¶ñÈáéÊ•µ‰Ω≥„ÄÇ" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "Âª∫ÁØâÂ§úÊôØÈùûÂ∏∏Â£ØÈ∫ó„ÄÇ" 
		}
      ]
    },
	{
      name: "Âè∞Âåó101",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "Â£ØËßÄÁöÑÂú∞Ê®ôÂª∫ÁØâÔºåËßÄÊôØÂè∞Ë¶ñÈáéÊ•µ‰Ω≥„ÄÇ" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "Âª∫ÁØâÂ§úÊôØÈùûÂ∏∏Â£ØÈ∫ó„ÄÇ" 
		}
      ]
    },
	{
      name: "Âè∞Âåó101",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "Â£ØËßÄÁöÑÂú∞Ê®ôÂª∫ÁØâÔºåËßÄÊôØÂè∞Ë¶ñÈáéÊ•µ‰Ω≥„ÄÇ" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "Âª∫ÁØâÂ§úÊôØÈùûÂ∏∏Â£ØÈ∫ó„ÄÇ" 
		}
      ]
    },
    {
      name: "ÈºéÊ≥∞Ë±ê",
      category: "ÁæéÈ£ü",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/2/28/Din_Tai_Fung.jpg", 
			review: "ÂøÖÂêÉÂ∞èÁ±†ÂåÖÂêçÂ∫ó„ÄÇ" 
		}
      ]
    }
  ],
  2: [
    {
      name: "‰∏≠Ê≠£Á¥ÄÂøµÂ†Ç",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "ÂÖÖÊªøÊ≠∑Âè≤Ê∞õÂúçÁöÑÂª∫ÁØâ„ÄÇ" 
		}
      ]
    },
    {
      name: "Ë•øÈñÄÁî∫",
      category: "Ë≥ºÁâ©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ÁÜ±È¨ßÁöÑÂïÜÂúàÔºåÈùûÂ∏∏Â•ΩÈÄõ„ÄÇ" 
		}
      ]
    }
  ],
  3: [
    {
      name: "‰∏≠Ê≠£Á¥ÄÂøµÂ†Ç",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "ÂÖÖÊªøÊ≠∑Âè≤Ê∞õÂúçÁöÑÂª∫ÁØâ„ÄÇ" 
		}
      ]
    },
    {
      name: "Ë•øÈñÄÁî∫",
      category: "Ë≥ºÁâ©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ÁÜ±È¨ßÁöÑÂïÜÂúàÔºåÈùûÂ∏∏Â•ΩÈÄõ„ÄÇ" 
		}
      ]
    }
  ],
  4: [
    {
      name: "‰∏≠Ê≠£Á¥ÄÂøµÂ†Ç",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "ÂÖÖÊªøÊ≠∑Âè≤Ê∞õÂúçÁöÑÂª∫ÁØâ„ÄÇ" 
		}
      ]
    },
    {
      name: "Ë•øÈñÄÁî∫",
      category: "Ë≥ºÁâ©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ÁÜ±È¨ßÁöÑÂïÜÂúàÔºåÈùûÂ∏∏Â•ΩÈÄõ„ÄÇ" 
		}
      ]
    }
  ],
  5: [
    {
      name: "‰∏≠Ê≠£Á¥ÄÂøµÂ†Ç",
      category: "ÊôØÈªû",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "ÂÖÖÊªøÊ≠∑Âè≤Ê∞õÂúçÁöÑÂª∫ÁØâ„ÄÇ" 
		}
      ]
    },
    {
      name: "Ë•øÈñÄÁî∫",
      category: "Ë≥ºÁâ©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ÁÜ±È¨ßÁöÑÂïÜÂúàÔºåÈùûÂ∏∏Â•ΩÈÄõ„ÄÇ" 
		}
      ]
    }
  ]
  // ÂÖ∂‰ªñÂ§©ÂèØ‰æùÈúÄÊ±ÇËá™Ë°åÂä†
};

// ‰∏çÂêåÂàÜÈ°ûÂ∞çÊáâÈ°èËâ≤ËàáSVGÂúñÁ§∫
const categoryStyles = {
  "ÁæéÈ£ü": {
    color: "#FFB870",
	'class': 'tag-food',
    icon: `üçΩÔ∏è`
  },
  "ÊôØÈªû": {
    color: "#7ED957",
	'class': 'tag-spot',
    icon: `üèûÔ∏è`
  },
  "Ë≥ºÁâ©": {
    color: "#66B3FF",
	'class': 'tag-shop',
    icon: `üõçÔ∏è`
  }
};

const tabButtons = document.querySelectorAll('.tab-button');
const daySchedules = document.querySelectorAll('.day-schedule');
const placeInfoEl = document.getElementById('place-info');
const prevInfoBtn = document.getElementById('prev-info');
const nextInfoBtn = document.getElementById('next-info');
const mapFrame = document.getElementById('mapFrame');

let currentPlace = null;
let currentInfoIndex = 0;

// Ê∏≤ÊüìÊØèÊó•Ë°åÁ®ã
function renderItinerary() {
  daySchedules.forEach(schedule => {
    const day = schedule.getAttribute('data-day');
    schedule.innerHTML = '';

    (itineraryData[day] || []).forEach((place) => {
      const category = categoryStyles[place.category] || { color: "#ccc", icon: "" };
      const item = document.createElement('div');
	  item.className = 'spot-button';
	  const cfg = categoryStyles[place.category];
	  item.innerHTML = `<span>${place.name}</span><span class="tag ${cfg.class}">${cfg.icon} ${place.category}</span>`;

      item.addEventListener('click', () => {
        currentPlace = place;
        currentInfoIndex = 0;
        showPlaceInfo();
		// Ê∏ÖÈô§ÂÖ∂‰ªñ item ÁöÑ active class
		document.querySelectorAll('.spot-button').forEach(el => {
			el.classList.remove('active');
		});

		  // Âπ´ÁõÆÂâçÈªûÂà∞ÁöÑ item Âä†‰∏ä active
		item.classList.add('active');
      });

      schedule.appendChild(item);
    });
  });
  if (daySchedules.length > 0) {
      const firstSpotButton = daySchedules[0].querySelector('.spot-button');
      firstSpotButton && firstSpotButton.click(); // Ëá™ÂãïËß∏ÁôºÁ¨¨‰∏ÄÂÄã spot-button ÁöÑÈªûÊìä‰∫ã‰ª∂
    }
  // ÈªûÊìäË©ïË´ñÂúñÁâá ‚Üí È°ØÁ§∫ÊîæÂ§ßÂúñÂ±§
	document.addEventListener('click', function (e) {
	  if (e.target.tagName === 'IMG' && e.target.closest('#place-info')) {
		const modal = document.getElementById('image-modal');
		const modalImg = document.getElementById('modal-img');
		modal.style.display = 'flex';
		modalImg.src = e.target.src;
	  }
	});

	// ÈªûÊìäÈóúÈñâÊàñÂúñÂ±§ ‚Üí ÈóúÈñâÊîæÂ§ßÂúñÂ±§
	document.querySelector('.image-modal .close-btn').addEventListener('click', () => {
	  document.getElementById('image-modal').style.display = 'none';
	});

	document.getElementById('image-modal').addEventListener('click', (e) => {
	  if (e.target.id === 'image-modal') {
		document.getElementById('image-modal').style.display = 'none';
	  }
	});
}

// È°ØÁ§∫ÊôØÈªûË≥áË®ä
function showPlaceInfo() {
  if (!currentPlace) return;
  const info = currentPlace.info[currentInfoIndex];
  placeInfoEl.innerHTML = `
    <img src="${info.img}" alt="${currentPlace.name}">
    <h3>${currentPlace.name} <span style="font-size:0.8rem;color:#666;">(${currentPlace.category})</span></h3>
    <p>${info.review}</p>
    <p style="font-size:0.8rem;color:#888;">${currentInfoIndex + 1} / ${currentPlace.info.length}</p>
  `;
  mapFrame.src = currentPlace.map_location;
}

function changeInfo(){
	if (!currentPlace) return;
  const info = currentPlace.info[currentInfoIndex];
  placeInfoEl.innerHTML = `
    <img src="${info.img}" alt="${currentPlace.name}">
    <h3>${currentPlace.name} <span style="font-size:0.8rem;color:#666;">(${currentPlace.category})</span></h3>
    <p>${info.review}</p>
    <p style="font-size:0.8rem;color:#888;">${currentInfoIndex + 1} / ${currentPlace.info.length}</p>
  `;
  
}

// ÂàáÊèõË≥áË®ä
prevInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex - 1 + currentPlace.info.length) % currentPlace.info.length;
    changeInfo();
  }
});

nextInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex + 1) % currentPlace.info.length;
    changeInfo();
  }
});

// Tabs ÂàáÊèõ
tabButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const day = btn.getAttribute('data-day');
    tabButtons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    daySchedules.forEach(s => s.classList.remove('active'));
    document.querySelector(`.day-schedule[data-day="${day}"]`).classList.add('active');
  });
});

// ÂàùÂßãÂåñ

window.addEventListener('DOMContentLoaded', renderItinerary);
