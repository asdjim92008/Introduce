// ğŸ—“ï¸ å¤šç­†è³‡æ–™ + åˆ†é¡
const itineraryData = {
  1: [
    {
      name: "è‚‰è›‹é£¯ç³°",
      category: "ç¾é£Ÿ",
	  map_location:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6020.424447080302!2d127.64619103042679!3d26.204295974549215!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34e569b79929e9c5%3A0x97508c627485ac4a!2z54-A5aGU55GqIOmCo-mcuOapn-WgtOWci-WFp-e3muWIsOmBlOWkp-W7s-W6lw!5e0!3m2!1szh-TW!2stw!4v1761056553806!5m2!1szh-TW!2stw",
      info: [
		{ 
			img: "t1menu.jpg", 
			review: "èœå–®" 
		},
		{ 
			img: "t1p1.jpg", 
			review: "é€™æ¬¡å“åšåœ‹å…§ç·šçš„åˆ†åº—ï¼Œéœ€è¦æ’éšŠåŠå°æ™‚å·¦å³ï¼Œæœ€å¥½åƒçš„æ˜¯å±±è‹¦ç“œå£å‘³ï¼Œæ¥è‘—æ˜¯æ‹›ç‰Œå£å‘³ï¼Œæ•´é«”ä¾†èªªæ­é…åˆé¤è‚‰æ˜¯å¥½åƒçš„ï¼Œä½†åƒ¹æ ¼åè²´" 
		},
        { 
			img: "t1p2.jpg", 
			review: "åœ¨åšæ²–ç¹©æ—…éŠåŠŸèª²çš„æ™‚å€™ï¼Œå¾ˆå¤šäººæ¨è–¦çš„é‚£éœ¸æ©Ÿå ´å¿…åƒã€Œè±¬è‚‰è›‹é£¯ç³° pork tamago onigiriã€ï¼Œé‚„å¥½æˆ‘ä¸€æ—©8ï¼š30è¦åœ¨é‚£éœ¸æ©Ÿå ´åOTSçš„æ¥é§è»Šï¼Œæ‰€ä»¥å¯ä»¥å…ˆä¾†åšé®®ä¸€ç•ªï¼Œè€Œä¸”ä¹Ÿä¸ç”¨æ’éšŠ~<br>å£å‘³é‚„ç®—ä¸éŒ¯ï¼Œä»½é‡ä¹Ÿé©ä¸­ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ç®—æ˜¯å¿…åƒç¾é£Ÿ~<br>æ‡‰è©²èªªæ˜¯åƒä¸€ç¨®å„€å¼æ„Ÿï¼Œæœ‰ä¾†åƒéæ‰èƒ½ç®—ä¾†éé‚£éœ¸æ©Ÿå ´å§ğŸ˜" 
		},
        { 
			img: "t1p3.jpg", 
			review: "é‚£éœ¸æ©Ÿå ´ï¼ˆNaha Airportï¼‰<br>9:20æŠµé”ï¼Œå‡ºé—œå¾Œå‰å¾€åœ‹å…§ç·šæ‰¾åƒçš„...<br>æ’éšŠé»é¤åˆ°å–é¤ï¼Œå¤§æ¦‚åªèŠ±äº†15åˆ†é˜ï¼Œè »å¿«çš„ã€‚<br>é£¯åœ˜çœŸçš„å¥½å¥½åƒï¼Œè‹¦ç“œå¤©å©¦ç¾…å£å‘³è¶…ç´šå¥½åƒ....<br>å‡éŠ·ç´„600-650æ—¥å…ƒ" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
	{
      name: "å°åŒ—101",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "ttt.png", 
			review: "å£¯è§€çš„åœ°æ¨™å»ºç¯‰ï¼Œè§€æ™¯å°è¦–é‡æ¥µä½³ã€‚" 
		},
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/f/f4/Taipei_101_2022.jpg", 
			review: "å»ºç¯‰å¤œæ™¯éå¸¸å£¯éº—ã€‚" 
		}
      ]
    },
    {
      name: "é¼æ³°è±",
      category: "ç¾é£Ÿ",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/2/28/Din_Tai_Fung.jpg", 
			review: "å¿…åƒå°ç± åŒ…ååº—ã€‚" 
		}
      ]
    }
  ],
  2: [
    {
      name: "ä¸­æ­£ç´€å¿µå ‚",
      category: "æ™¯é»",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Chiang_Kai-shek_Memorial_Hall_2008.jpg", 
			review: "å……æ»¿æ­·å²æ°›åœçš„å»ºç¯‰ã€‚" 
		}
      ]
    },
    {
      name: "è¥¿é–€ç”º",
      category: "è³¼ç‰©",
	  map_location:"https://www.google.com/maps?q=25.033968,121.564468&z=16&output=embed",
      info: [
        { 
			img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Ximending_at_night.jpg", 
			review: "ç†±é¬§çš„å•†åœˆï¼Œéå¸¸å¥½é€›ã€‚" 
		}
      ]
    }
  ]
  // å…¶ä»–å¤©å¯ä¾éœ€æ±‚è‡ªè¡ŒåŠ 
};

// ä¸åŒåˆ†é¡å°æ‡‰é¡è‰²èˆ‡SVGåœ–ç¤º
const categoryStyles = {
  "ç¾é£Ÿ": {
    color: "#FFB870",
	'class': 'tag-food',
    icon: `ğŸ½ï¸`
  },
  "æ™¯é»": {
    color: "#7ED957",
	'class': 'tag-spot',
    icon: `ğŸï¸`
  },
  "è³¼ç‰©": {
    color: "#66B3FF",
	'class': 'tag-shop',
    icon: `ğŸ›ï¸`
  }
};

const tabButtons = document.querySelectorAll('.tab-button');
const daySchedules = document.querySelectorAll('.day-schedule');
const placeInfoEl = document.getElementById('place-info');
const prevInfoBtn = document.getElementById('prev-info');
const nextInfoBtn = document.getElementById('next-info');
const mapFrame = document.getElementById('mapFrame');

let currentPlace = null;
let currentInfoIndex = 0;

// æ¸²æŸ“æ¯æ—¥è¡Œç¨‹
function renderItinerary() {
  daySchedules.forEach(schedule => {
    const day = schedule.getAttribute('data-day');
    schedule.innerHTML = '';

    (itineraryData[day] || []).forEach((place) => {
      const category = categoryStyles[place.category] || { color: "#ccc", icon: "" };
      const item = document.createElement('div');
	  item.className = 'spot-button';
	  const cfg = categoryStyles[place.category];
	  item.innerHTML = `<span>${place.name}</span><span class="tag ${cfg.class}">${cfg.icon} ${place.category}</span>`;

      item.addEventListener('click', () => {
        currentPlace = place;
        currentInfoIndex = 0;
        showPlaceInfo();
		// æ¸…é™¤å…¶ä»– item çš„ active class
		document.querySelectorAll('.spot-button').forEach(el => {
			el.classList.remove('active');
		});

		  // å¹«ç›®å‰é»åˆ°çš„ item åŠ ä¸Š active
		item.classList.add('active');
      });

      schedule.appendChild(item);
    });
  });
  if (daySchedules.length > 0) {
      const firstSpotButton = daySchedules[0].querySelector('.spot-button');
      firstSpotButton && firstSpotButton.click(); // è‡ªå‹•è§¸ç™¼ç¬¬ä¸€å€‹ spot-button çš„é»æ“Šäº‹ä»¶
    }
}

// é¡¯ç¤ºæ™¯é»è³‡è¨Š
function showPlaceInfo() {
  if (!currentPlace) return;
  const info = currentPlace.info[currentInfoIndex];
  placeInfoEl.innerHTML = `
    <img src="${info.img}" alt="${currentPlace.name}">
    <h3>${currentPlace.name} <span style="font-size:0.8rem;color:#666;">(${currentPlace.category})</span></h3>
    <p>${info.review}</p>
    <p style="font-size:0.8rem;color:#888;">${currentInfoIndex + 1} / ${currentPlace.info.length}</p>
  `;
  mapFrame.src = currentPlace.map_location;
}

function changeInfo(){
	if (!currentPlace) return;
  const info = currentPlace.info[currentInfoIndex];
  placeInfoEl.innerHTML = `
    <img src="${info.img}" alt="${currentPlace.name}">
    <h3>${currentPlace.name} <span style="font-size:0.8rem;color:#666;">(${currentPlace.category})</span></h3>
    <p>${info.review}</p>
    <p style="font-size:0.8rem;color:#888;">${currentInfoIndex + 1} / ${currentPlace.info.length}</p>
  `;
}

// åˆ‡æ›è³‡è¨Š
prevInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex - 1 + currentPlace.info.length) % currentPlace.info.length;
    changeInfo();
  }
});

nextInfoBtn.addEventListener('click', () => {
  if (currentPlace) {
    currentInfoIndex = (currentInfoIndex + 1) % currentPlace.info.length;
    changeInfo();
  }
});

// Tabs åˆ‡æ›
tabButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const day = btn.getAttribute('data-day');
    tabButtons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    daySchedules.forEach(s => s.classList.remove('active'));
    document.querySelector(`.day-schedule[data-day="${day}"]`).classList.add('active');
  });
});

// åˆå§‹åŒ–
window.addEventListener('DOMContentLoaded', renderItinerary);